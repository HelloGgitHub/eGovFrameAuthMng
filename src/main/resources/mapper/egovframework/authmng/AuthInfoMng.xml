<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.com.auth.dao.AuthInfoDao">

	<!-- Maria -->
    <select id="selectAuthList" resultType="hashMap">
			SELECT AUTHOR_CODE
			     , AUTHOR_NM
			     , AUTHOR_DC
			     , AUTHOR_CREAT_DT
			     , CHANGE_DT
			  FROM COMTNAUTHORINFO
    </select>
    
    <select id="selectAuthDetail"  parameterType="Map" resultType="hashMap">
			SELECT AUTHOR_CODE
			     , AUTHOR_NM
			     , AUTHOR_DC
			     , AUTHOR_CREAT_DT
			     , CHANGE_DT
			  FROM COMTNAUTHORINFO
			 WHERE AUTHOR_CODE = '${AUTHCD}'
    </select>


    <insert id="insertAuthInfo" parameterType="hashMap">
			INSERT INTO COMTNAUTHORINFO (
			  AUTHOR_CODE
			, AUTHOR_NM
			, AUTHOR_DC
			, AUTHOR_CREAT_DT
			, CHANGE_DT
			) VALUES (
			  #{AUTHCD}
			, #{AUTHNM}
			, #{AUTHDC}
			, DATE_FORMAT(CURRENT_TIMESTAMP, '%Y%m%d%H%i%s')
			, DATE_FORMAT(CURRENT_TIMESTAMP, '%Y%m%d%H%i%s')
			)
    </insert>
    
    <update id="updateGrpInfo" parameterType="hashMap">
			UPDATE COMTNAUTHORINFO
			   SET CHANGE_DT = DATE_FORMAT(CURRENT_TIMESTAMP, '%Y%m%d%H%i%s')
			    <if test='AUTHNM != null'> 	, AUTHOR_NM	= '${AUTHNM}' 	</if>
			    <if test='AUTHDC != null'> 	, AUTHOR_DC	= '${AUTHDC}' 	</if>
			 WHERE AUTHOR_CODE           = '${AUTHCD}'
    </update>
    
    <delete id="deleteGrpInfo" parameterType="hashMap">
			DELETE FROM COMTN_GROUP_INFO
			 WHERE GROUP_ID           = '${GROUP_ID}'
    </delete>
    
    
    <select id="selectGrpUsrList" parameterType="Map" resultType="hashMap">
			SELECT GROUP_ID
			     , USR_ID
			     , ADD_DT
			  FROM COMTN_GROUP_USR
			 WHERE GROUP_ID = '${GRP_ID}'
    </select>

    <insert id="insertGrpUsr" parameterType="hashMap">
			INSERT INTO COMTN_GROUP_USR (
			  GROUP_ID
			, USR_ID
			, ADD_DT
			) VALUES (
			  #{GRP_ID}
			, #{USR_ID}
			, DATE_FORMAT(CURRENT_TIMESTAMP, '%Y%m%d%H%i%s')
			)
    </insert>
     <select id="selectGrpUsrCk" parameterType="Map" resultType="int">
			SELECT COUNT(*) as cnt
			  FROM COMTN_GROUP_USR
			 WHERE GROUP_ID = '${GRP_ID}'
			   AND USR_ID = '${USR_ID}'
    </select>
    
    <delete id="deleteGrpUsr" parameterType="hashMap">
			DELETE FROM COMTN_GROUP_USR
			 WHERE GROUP_ID           = '${GRP_ID}'
			   AND USR_ID           = '${USR_ID}'
    </delete>
    
</mapper> 